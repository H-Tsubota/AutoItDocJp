<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Function Call</title>
  <meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">Call</font>
<hr size="2">
<p>文字列パラメータに基づいてユーザー定義関数を実行します。<br></p>

<p class="codeheader">
Call ( "function" [, param1 [, param2 [, param<i>N</i> ]]] )<br>
</p>
<p>&nbsp;</p>

<p><b>パラメータ</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">function</td>
    <td width="85%">実行するユーザー定義関数の名前</td>
  </tr>
  <tr>
   <td>param</td>
   <td>実行時に関数に渡される引数</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>返し値</b></p>
<table width="100%">
  <tr>
    <td width="10%" valign="top">成功</td>
    <td width="90%">実行した関数の返し値を返します。また呼び出した関数が@errorと@extendedを設定する場合は@errorと@extendedにその値が格納されます。</td>
  </tr>
  <tr>
    <td valign="top">失敗</td>
    <td>関数が存在しない場合やパラメータの数が正しくない場合、@errorに0xDEAD、@extendedに0xBEEFを設定します。</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>注意</b></p>
<i>function</i>にAutoItの組み込み関数、プラグイン関数を指定することはできません。<br>
関数に引数を渡すことは可能ですが、ByRefパラメータはサポートされていません。ByRefパラメータを取得する方法はありません。<br>
個別のパラメータの代わりに配列を使ってパラメータを渡すことが可能です。配列の最初の要素には"CallArgArray"を代入し、1-<i>n</i>番目の要素に関数に渡すパラメータをそれぞれ設定します。この配列を使用してパラメータを渡す場合、他のパラメータはCall()に渡されません。例を参照してください。<br>
Call()も、呼び出される関数も@errorを設定することができます。Call()が@errorを設定する場合はその値は0xDEADで@extendedも0xBEEFに設定されます。存在しない関数を呼び出すデモの例を参照してください。<br>
<br>
<p>&nbsp;</p>

<p><b>関連</b></p>
<a href="Execute.htm">Execute</a>
<p>&nbsp;</p>

<p><b>例</b></p>
<p class="codebox">
<br>
<span><span class="S1">; 引数の無い関数を実行</span><br>
<span class="S4">Call</span><span class="S8">(</span><span class="S7">"Test1"</span><span class="S8">)</span><br>
<br>
<span class="S1">; 引数1つの関数に引数を与えて実行</span><br>
<span class="S4">Call</span><span class="S8">(</span><span class="S7">"Test2"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Message from Call()!"</span><span class="S8">)</span><br>
<br>
<span class="S1">; 配列を使って引数を渡す方法のデモ</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$aArgs</span><span class="S8">[</span><span class="S3">4</span><span class="S8">]</span><br>
<span class="S9">$aArgs</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"CallArgArray"</span><span class="S0"> </span><span class="S1">; 必須。もし無いとCall()は引数のはいった配列と認識できない。</span><br>
<span class="S9">$aArgs</span><span class="S8">[</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"This is a string"</span><span class="S0">&nbsp; </span><span class="S1">; 1つ目のパラメータは文字列</span><br>
<span class="S9">$aArgs</span><span class="S8">[</span><span class="S3">2</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">47</span><span class="S0">&nbsp; </span><span class="S1">; 2つ目のパラメータは数値</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$array</span><span class="S8">[</span><span class="S3">2</span><span class="S8">]</span><br>
<span class="S9">$array</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Array Element 0"</span><br>
<span class="S9">$array</span><span class="S8">[</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Array Element 1"</span><br>
<span class="S9">$aArgs</span><span class="S8">[</span><span class="S3">3</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$array</span><span class="S0">&nbsp; </span><span class="S1">; 2つ目のパラメータは配列</span><br>
<br>
<span class="S1">; 作成した引数配列で関数を実行</span><br>
<span class="S4">Call</span><span class="S8">(</span><span class="S7">"Test3"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aArgs</span><span class="S8">)</span><br>
<br>
<span class="S1">; 存在しない関数の呼び出しテスト。&nbsp;@errorと@extendedにドキュメントに書かれた失敗値</span><br>
<span class="S1">; が格納されているかどうかを調べる適切なテスト方法を示す。</span><br>
<span class="S5">Local</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$sFunction</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"DoesNotExist"</span><br>
<span class="S4">Call</span><span class="S8">(</span><span class="S9">$sFunction</span><span class="S8">)</span><br>
<span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0xDEAD</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S6">@extended</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0xBEEF</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">4096</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Function does not exist."</span><span class="S8">)</span><br>
<br>
<span class="S5">Func</span><span class="S0"> Test1</span><span class="S8">()</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">4096</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Hello"</span><span class="S8">)</span><br>
<span class="S5">EndFunc</span><br>
<br>
<span class="S5">Func</span><span class="S0"> Test2</span><span class="S8">(</span><span class="S9">$sMsg</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">4096</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sMsg</span><span class="S8">)</span><br>
<span class="S5">EndFunc</span><br>
<br>
<span class="S5">Func</span><span class="S0"> Test3</span><span class="S8">(</span><span class="S9">$sString</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nNumber</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aArray</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">4096</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"The string is: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sString</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">4096</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"The number is: "</span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$nNumber</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aArray</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">4096</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Array["</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"] contains:"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$aArray</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">])</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br>
<span class="S5">EndFunc</span><br>
<span class="S0"></span></span><br>
<script type="text/javascript">

if (document.URL.match(/^mk:@MSITStore:/i))
document.write('<br><OBJECT id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" width=58 height=57><PARAM name="Command" value="ShortCut"><PARAM name="Button" value="Text:Open this Script"><PARAM name="Item1" value=",Examples\\HelpFile\\Call.au3,"></OBJECT>');
</script>
<p>&nbsp;</p>

</body>
</html>
