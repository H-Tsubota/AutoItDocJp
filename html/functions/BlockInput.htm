<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Function BlockInput</title>
  <meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">BlockInput</font>
<hr size="2">
<p>マウスとキーボードの無効/有効を切り替えます。<br></p>

<p class="codeheader">
BlockInput ( flag )<br>
</p>
<p>&nbsp;</p>

<p><b>パラメータ</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">flag</td>
    <td width="85%">1 = ユーザー入力を無効にします。<br>
       0 = ユーザー入力を有効にします。</td>
  </tr>
</table>

<p>&nbsp;</p>

<p><b>返し値</b></p>
<table width="100%">
  <tr>
    <td width="10%" valign="top">成功</td>
    <td width="90%">1を返します。</td>
  </tr>
  <tr>
    <td valign="top">失敗</td>
    <td>0を返します。 既に有効であるか #requireAdminが使用されていません。</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>注意</b></p>
下の表はBlockInputがWindowsの各バージョンでどのように動作するかをまとめたものです。またWindowsAPIの特性から全てのバージョンでCtrl+Alt+Delによって入力を有効にすることができます。<br>
<br><br>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%"><b><i>OS</b></i></td>
    <td width="85%"><b><i>"BlockInput" の結果</b></i></td>
  </tr>
  <tr>
   <td>Windows 2000</td>
   <td>ユーザーによる入力はブロックされます。AutoItによるマウス入力、キーボード入力は可能です。</td>
  </tr>
  <tr>
   <td>Windows XP</td>
   <td>ユーザーによる入力はブロックされます。AutoItによるマウス入力、キーボード入力は可能です。Windows XP SP1での問題については下の注意を参照してください。</td>
  </tr>
  <tr>
   <td>Windows Vista</td>
   <td>#RequireAdminが使用されている場合、ユーザーによる入力はブロックされます。AutoItによるマウス入力、キーボード入力は可能です。</td>
  </tr>
</table><br>
Blockinput()中に(Send()関数による)ALTキーを送信できなくなるバグに対するWindowsの修正がWindows XP SP1でリリースされています。このWindowsのバグはWindows XP SP2以降では修正済みです。<br>
<br>
BlockInput()はユーザー入力にのみ作用します。Send()やMouseMove()といった関数からの入力は動作します。<br>
<br>
<p>&nbsp;</p>

<p><b>関連</b></p>
<a href="Send.htm">Send</a>
<p>&nbsp;</p>

<p><b>例</b></p>
<p class="codebox">
<br>
<span><span class="S4">BlockInput</span><span class="S8">(</span><span class="S3">1</span><span class="S8">)</span><br>
<br>
<span class="S4">Run</span><span class="S8">(</span><span class="S7">"notepad"</span><span class="S8">)</span><br>
<span class="S4">WinWaitActive</span><span class="S8">(</span><span class="S7">"[CLASS:Notepad]"</span><span class="S8">)</span><br>
<span class="S4">Send</span><span class="S8">(</span><span class="S7">"</span><span class="S10">{F5}</span><span class="S7">"</span><span class="S8">)</span><span class="S0"> &nbsp;</span><span class="S1">; 日時をペースト</span><br>
<br>
<span class="S4">BlockInput</span><span class="S8">(</span><span class="S3">0</span><span class="S8">)</span><br>
<span class="S0"></span></span><br>
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i))
document.write('<br><OBJECT id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" width=58 height=57><PARAM name="Command" value="ShortCut"><PARAM name="Button" value="Text:Open this Script"><PARAM name="Item1" value=",Examples\\HelpFile\\BlockInput.au3,"></OBJECT>');
</script>
<p>&nbsp;</p>

</body>
</html>
