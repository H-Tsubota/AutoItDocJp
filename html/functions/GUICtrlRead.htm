<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Function GUICtrlRead</title>
  <meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">GUICtrlRead</font>
<hr size="2">
<p>コントロールの状態またはデータを読み取ります。<br></p>

<p class="codeheader">
GUICtrlRead ( controlID [, advanced] )<br>
</p>
<p>&nbsp;</p>

<p><b>パラメータ</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">controlID</td>
    <td width="85%"><a href="GUICtrlCreate%20Management.htm">GUICtrlCreate...</a>関数によって返されるコントロール識別子(コントロールID)。</td>
  </tr>
  <tr>
   <td>advanced</td>
   <td><b>[オプション]</b> コントロールの拡張情報を返すかどうか。<br>
       0 = (デフォルト) コントロールの状態またはデータを表す値を返します。<br>
       1 = コントロールの拡張情報を返します(注意を参照)。</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>返し値</b></p>
<table width="100%">
  <tr>
    <td width="10%" valign="top">成功</td>
    <td width="90%">コントロールによって異なります(下記参照)。</td>
  </tr>
  <tr>
    <td valign="top">失敗</td>
    <td>0を返します。</td>
  </tr>
</table><table width="100%" border="1" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td style="border-bottom-style: solid; border-bottom-width: 1"><b>種類</b></td>
    <td style="border-bottom-style: solid; border-bottom-width: 1"><b>値</b></td>
  </tr>
  <tr>
    <td>チェックボックス、ラジオ</td>
    <td>ボタンの状態。<a href="GUICtrlSetState.htm#StateTable">状態表を参照</a></td>
  </tr>
  <tr>
    <td>コンボ、リスト</td>
    <td>選択されている値</td>
  </tr>
  <tr>
    <td>インプット、エディット</td>
    <td>入力されているテキスト</td>
  </tr>
  <tr>
    <td>ボタン</td>
    <td>表示されているテキスト</td>
  </tr>
  <tr>
    <td>日付</td>
    <td>選択されている日付</td>
  </tr>
  <tr>
    <td>プログレス</td>
    <td>現在のパーセンテージ</td>
  </tr>
  <tr>
    <td>スライダー</td>
    <td>現在の値</td>
  </tr>
  <tr>
    <td>タブ</td>
    <td>advancedパラメータの値に従って、選択されているタブアイテムの番号またはコントロールID。</td>
  </tr>
  <tr>
    <td>メニュー、メニューアイテム</td>
    <td>
	メニュー/アイテムの状態。<a href="GUICtrlSetState.htm#StateTable">状態表を参照</a></td>
  </tr>
  <tr>
    <td>ツリービュー</td>
    <td>選択されているツリービューアイテムのコントロール識別子(コントロールID)</td>
  </tr>
  <tr>
    <td>ツリービューアイテム</td>
    <td>ツリービューアイテムの状態</td>
  </tr>
  <tr>
    <td>リストビュー</td>
    <td>選択されているリストビューアイテムのコントロール識別子(コントロールID)。アイテムが選択されていない場合0。</td>
  </tr>
  <tr>
    <td>ダミー</td>
    <td><a href="GUICtrlSendToDummy.htm">GUICtrlSendToDummy</a>または<a href="GUICtrlSetData.htm">GUICtrlSetData</a>で設定された値</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>注意</b></p>
'advanced'モードでは返し値はコントロールの追加データを格納しています(下記参照)。<br>
<br>
注意：全てのコントロールで追加データが利用できるわけではありません!<br>
<br><br>
<table width="100%" border="1" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td style="border-bottom-style: solid; border-bottom-width: 1"><b>種類</b></td>
    <td style="border-bottom-style: solid; border-bottom-width: 1"><b>追加データ</b></td>
  </tr>
  <tr>
    <td>チェックボックス、ラジオ</td>
    <td>コントロールのテキスト。</td>
  </tr>
  <tr>
    <td>メニュー、メニューアイテム</td>
    <td>コントロールのテキスト。</td>
  </tr>
  <tr>
    <td>ツリービュー</td>
    <td>現在選択されているツリービューアイテムのテキスト。</td>
  </tr>
  <tr>
    <td>ツリービューアイテム</td>
    <td>ツリービューアイテムのテキスト。</td>
  </tr>
  <tr>
    <td>リストビューアイテム</td>
    <td>advancedモードで$LVS_EX_CHECKBOXES拡張スタイルが使用されている場合、リストビューアイテムの状態。
	<a href="GUICtrlSetState.htm#StateTable">状態表を参照</a></td>
  </tr>
  <tr>
    <td>タブ</td>
    <td>選択されているタブアイテムのコントロールID</td>
  </tr>
</table><br>
チェックボックスコントロール、ラジオコントロールでは$GUI_FOCUSと$GUI_CHECKEDの2つ状態が返されます。例えばコントロールがチェックされているかどうかはBitAnd(GUICtrlRead($Item),$GUI_CHECKED)のようにして調べてください。<br>
<br>
リストビューアイテムでは$GUI_CHECKEDと$GUI_UNCHECKEDの2つ状態が返されます(リストビューコントロールに拡張スタイルLVS_EX_CHECKBOXESが設定され、'advanced'モードの場合のみ)。例えばコントロールがチェックされているかどうかはBitAnd(GUICtrlRead($Item),$GUI_CHECKED)のようにして調べてください。<br>
<br>
ツリービューアイテムでは$GUI_FOCUS、$GUI_EXPAND、GUI_CHECKED、GUI_UNCHECKEDの複数の状態が返されます(ツリービューコントロールにスタイルTVS_CHECKBOXESが設定されている場合のみ)。例えばコントロールがチェックされているかどうかはBitAnd(GUICtrlRead($Item),$GUI_CHECKED)のようにして調べてください。<br>
<br>
<p>&nbsp;</p>

<p><b>関連</b></p>
<a href="GUICtrlUpdate%20Management.htm">GUICtrlUpdate...</a>, <a href="GUIGetMsg.htm">GUIGetMsg</a>, <a href="GUICtrlSetData.htm">GUICtrlSetData</a>, <a href="AutoItSetOption.htm#GUIEventOptions">GUIEventOptions (Option)</a>, <a href="GUICtrlCreate%20Management.htm">GUICtrlCreate...</a>, <a href="GUICtrlGetState.htm">GUICtrlGetState</a>, <a href="GUICtrlSendToDummy.htm">GUICtrlSendToDummy</a>, <a href="GUICtrlSendMsg.htm">GUICtrlSendMsg</a>
<p>&nbsp;</p>

<p><b>例</b></p>
<p class="codebox">
<br>
<span><span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;GUIConstantsEx.au3&gt;</span><br>
<br>
<span class="S4">Opt</span><span class="S8">(</span><span class="S7">'MustDeclareVars'</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br>
<br>
<span class="S0">Example</span><span class="S8">()</span><br>
<br>
<span class="S5">Func</span><span class="S0"> Example</span><span class="S8">()</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$menu1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$n1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$n2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$msg</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$menustate</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$menutext</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICreate</span><span class="S8">(</span><span class="S7">"My GUICtrlRead"</span><span class="S8">)</span><span class="S0"> </span><span class="S1">; 表示時に中央に表示されるダイアログボックスを作成</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$menu1</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateMenu</span><span class="S8">(</span><span class="S7">"File"</span><span class="S8">)</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$n1</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateList</span><span class="S8">(</span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">100</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"item1|item2|item3"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"item2"</span><span class="S8">)</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$n2</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"Read"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">110</span><span class="S8">,</span><span class="S0"> </span><span class="S3">50</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetState</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FOCUS</span><span class="S8">)</span><span class="S0"> </span><span class="S1">; フォーカスをこのボタンに設定</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUISetState</span><span class="S8">()</span><span class="S0"> </span><span class="S1">; 空のダイアログボックスを表示</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; ダイアログが閉じられるまでGUIを実行</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Do</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$msg</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUIGetMsg</span><span class="S8">()</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$msg</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$n2</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Selected listbox entry"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$n1</span><span class="S8">))</span><span class="S0"> </span><span class="S1">; 選択されたリストボックスエントリーを表示</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$menustate</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$menu1</span><span class="S8">)</span><span class="S0"> </span><span class="S1">; メニューアイテムの状態を返す</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$menutext</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$menu1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><span class="S0"> </span><span class="S1">; メニューアイテムのテキストを返す</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"State and text of the menuitem"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"state:"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$menustate</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"text:"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$menutext</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Until</span><span class="S0"> </span><span class="S9">$msg</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$GUI_EVENT_CLOSE</span><br>
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;Example</span></span><br>
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i))
document.write('<br><OBJECT id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" width=58 height=57><PARAM name="Command" value="ShortCut"><PARAM name="Button" value="Text:Open this Script"><PARAM name="Item1" value=",Examples\\HelpFile\\GUICtrlRead.au3,"></OBJECT>');
</script>
<p>&nbsp;</p>
</body>
</html>
