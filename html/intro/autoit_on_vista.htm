<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>AutoIt on Windows Vista</title>
  <meta http-equiv="Content-Type"
 content="text/html; charset=shift-jis">
  <link href="../css/default.css" rel="stylesheet" type="text/css"></head>
<body>
<h1>AutoIt on Windows Vista </h1>
<p>
Windows Vistaは管理者権限を要求するファイルの実行を制限するための新しいセキュリティ機能を持っています。たとえ管理者ユーザーであっても(レジストリキーHKEY_LOCAL_MACHINEやC:\Windowsへの書き込みなど)管理操作をともなう実行処理のたびにプロンプトが表示されます。これは<strong>ユーザーアカウント制御(UAC)</strong>と呼ばれます。</p>
<p>デフォルト設定ではAutoItスクリプトは標準ユーザー権限で実行されますがスクリプト作成者はスクリプトに実行時に完全な管理者権限が必要かどうかAutoItに通知するためのオプション&quot;タグ&quot;を付けることが可能です。</p>
<p>スクリプト実行時に管理者権限を必要とするようにするには<strong>#requireadmin</strong>命令を次のようにスクリプト冒頭に書き込みます。</p>
<p class="codebox">
; このスクリプトは完全な管理者権限を必要とする<br>
  #requireadmin<br>
  <br>
  MsgBox(0, "Info", "This script has admin rights! ")</p>
<p class="code">&nbsp;</p>
<p>スクリプト実行時にAutoItは完全な管理者権限が既に与えられているかどうかを調べます。もし与えられていない場合、オペレーティングシステムはユーザーが許可を与えるために&quot;UAC プロンプト&quot;に示すプロンプトを表示します。ユーザーによる許可が得られなかった場合スクリプトは終了します。</p>
<p>&nbsp;</p>
<h2>UAC プロンプト</h2>
<p>
管理者権限を必要とするプログラムを実行した際にVistaが表示するプロンプトを下に示します。表示されるプロンプトの種類はユーザーが&quot;標準ユーザー&quot;か&quot;管理者ユーザー&quot;かによって異なります(管理者であっても管理操作をおこなうためには昇格許可を得る必要があることに注意してください)。注意:示してあるプロンプトはAutoItのデジタル署名バージョンでのものです。全てのリリースバージョンは署名されていますがベータバージョンはされてません。ベータバージョンでは下の&quot;コンパイル済みスクリプト&quot;に示す警告が表示されます。</p>
<p>&nbsp;</p>
<p><strong>標準ユーザープロンプト</strong></p>
<p><img src="../images/autoit_standarduser_uac_signed.png" width="439" height="427"></p>
<p>
権限を昇格させてスクリプト実行を継続するためには標準ユーザーはユーザー名を選択しパスワードを入力しなければなりません。</p>
<p>&nbsp;</p>
<p><strong>管理者ユーザープロンプト</strong></p>
<p><img src="../images/autoit_uac_signed.png" width="439" height="241"></p>
<p>
既にユーザーが管理者で昇格だけが必要な場合、ユーザーはcontinueをクリックするだけでパスワードはいりません。</p>
<p>&nbsp;</p>
<h2>コンパイル済みスクリプト</h2>
<p>
コンパイル済みスクリプト(とAutoItのベータバージョン)はデジタル署名されておらず、次に示すより深刻にみえる警告が表示されます。</p>
<p><img src="../images/compiled_uac_unsigned.png" width="460" height="369"> </p>
<p>
処理を継続するためにユーザーは<strong>Allow</strong>をクリックしなければなりません(標準ユーザーの場合さらにパスワードを入力しなければなりません)。</p>
<p>あなたが自分のAuthenticode署名を持っている場合はコンパイル済みスクリプトに署名した方がいいでしょう。</p>
<p>&nbsp;</p>
<p><strong>重要: AutoItであろうとコンパイル済みスクリプトであろうと、署名されているかどうかに関わらず信頼できる開発元からのスクリプトのみ実行してください!</strong></p>
<p><strong><u>署名されたコードであっても悪意のあるものがあります!</u> </strong></p>
<p>&nbsp;</p>
</body>
</html>